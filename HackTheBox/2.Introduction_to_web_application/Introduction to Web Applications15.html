<!DOCTYPE html>

<!-- saved from url=(0052)https://academy.hackthebox.com/module/75/section/764 -->
<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Introduction to Web Applications</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Premium Multipurpose Admin &amp; Dashboard Template" name="description"/>
<meta content="Themesbrand" name="author"/>
<link href="https://academy.hackthebox.com/images/favicon.ico" rel="shortcut icon"/>
<link href="https://academy.hackthebox.com/images/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="https://academy.hackthebox.com/images/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="https://academy.hackthebox.com/images/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="https://academy.hackthebox.com/images/safari-pinned-tab.svg" rel="mask-icon"/>
<link data-style="dark" href="./Introduction to Web Applications15_files/bootstrap-dark.css" id="bootstrap-style" rel="stylesheet" type="text/css"/>
<link href="./Introduction to Web Applications15_files/icons.css" rel="stylesheet" type="text/css"/>
<link data-style="dark" href="./Introduction to Web Applications15_files/app-dark.css" id="app-style" rel="stylesheet" type="text/css"/>
<link data-style="dark" href="./Introduction to Web Applications15_files/prism.css" id="app-style" rel="stylesheet" type="text/css"/>
<link href="./Introduction to Web Applications15_files/toastr.min.css" rel="stylesheet" type="text/css"/>
<link href="./Introduction to Web Applications15_files/ryt3opf.css" rel="stylesheet"/>
<script async="" src="./Introduction to Web Applications15_files/awwxrc0h" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/uwt.js.download" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/insight.min.js.download" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/346791856678772"></script><script async="" src="./Introduction to Web Applications15_files/fbevents.js.download" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/analytics.js.download" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/commons.54701049fd6fb8497e9e.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/intercom.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/twitter-ads.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/linkedin-insight-tag.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/facebook-pixel.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/google-analytics.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" crossorigin="anonymous" integrity="sha384-TE9Ls1LqNaomGaFdDlxBJIkg+bFnKWbASEx9XrnnCV1SiORfW/qiKK2lsAbkVeBa" src="./Introduction to Web Applications15_files/recaptcha__en.js.download" type="text/javascript"></script><script async="" src="./Introduction to Web Applications15_files/analytics.min.js.download" type="text/javascript"></script><script>
        !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="eLzeD0QoARKZ42pc8AGEUYpcFLpYkf0I";analytics.SNIPPET_VERSION="4.13.2";
                analytics.load("eLzeD0QoARKZ42pc8AGEUYpcFLpYkf0I");
                                                        properties = {"platform":"Academy","platform_version":"V1","module_id":75,"module_name":"Introduction to Web Applications","module_difficulty":"Fundamental","section_id":764,"section_title":"Common Web Vulnerabilities"};
                                                analytics.page(
                    "Module",
                    properties
                );
                                            }
        }();
    </script>
<style>
    .website-screenshot-url {
        height: 22px;
        cursor: text;
        padding-left: 10px;
    }
</style>
<script src="./Introduction to Web Applications15_files/api.js.download"></script>
</head>
<body data-layout="detached" data-topbar="colored">
<div class="container-fluid">
<div id="layout-wrapper">
<header id="page-topbar">
<div class="navbar-header">
<div class="container-fluid">
<div class="float-right">
<div class="dropdown d-none d-lg-inline-block ml-1">
<a href="https://academy.hackthebox.com/billing">
<button class="btn btn-extra-light" type="button">
<i class="fad fa-cube text-success mt-1 mr-2"></i> Purchase Cubes
</button>
</a>
</div>
<div class="dropdown d-none d-lg-inline-block ml-1">
<button class="btn header-item noti-icon waves-effect" data-toggle="fullscreen" type="button">
<i class="mdi mdi-fullscreen"></i>
</button>
</div>
<div class="dropdown d-inline-block">
<button aria-expanded="false" aria-haspopup="true" class="btn header-item waves-effect" data-toggle="dropdown" id="page-header-user-dropdown" type="button">
<img alt="Header Avatar" class="rounded-circle header-profile-user" src="./Introduction to Web Applications15_files/1782606024b767354a8c9d75e1a6323a"/>
<span class="d-none d-xl-inline-block ml-1">Tommy034</span>
<i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
</button>
<div class="dropdown-menu dropdown-menu-right">
<a class="dropdown-item" href="https://academy.hackthebox.com/billing"><i class="bx bx-wallet font-size-16 align-middle mr-1"></i> Billing</a>
<a class="dropdown-item d-block" href="https://academy.hackthebox.com/settings"><i class="bx bx-wrench font-size-16 align-middle mr-1"></i> Settings</a>
<a class="dropdown-item d-block" href="https://academy.hackthebox.com/vpn"><i class="bx bx-server font-size-16 align-middle mr-1"></i> Vpn Settings</a>
<div class="dropdown-divider"></div>
<form action="https://academy.hackthebox.com/logout" method="POST"> <input name="_token" type="hidden" value="hFahg3PlVpA6oyzTnlKVFlcJ6V0GIvc59OYzEA7F"/> <a class="dropdown-item text-danger" href="https://academy.hackthebox.com/module/75/section/764#" onclick="$(this).closest('form').submit()"><i class="bx bx-power-off font-size-16 align-middle mr-1 text-danger"></i> Logout</a>
</form>
</div>
</div>
</div>
<div class="d-flex align-items-center">
<div class="navbar-brand-box">
<a class="logo" href="https://academy.hackthebox.com/dashboard">
<span class="logo-sm">
<img alt="" height="30" src="./Introduction to Web Applications15_files/logo.svg"/>
</span>
<span class="logo-lg">
<img alt="" height="36" src="./Introduction to Web Applications15_files/logo.svg"/>
</span>
</a>
</div>
<button class="btn btn-sm px-3 font-size-16 header-item toggle-btn waves-effect" id="vertical-menu-btn" type="button">
<i class="fa fa-fw fa-bars"></i>
</button>
<div class="topnav">
<nav class="navbar navbar-light navbar-expand-lg topnav-menu">
<div class="collapse navbar-collapse" id="topnav-menu-content">
<ul class="navbar-nav active">
<li class="nav-item">
<a class="nav-link" href="https://academy.hackthebox.com/dashboard"><i class="mdi mdi-monitor-dashboard"></i> Dashboard</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://academy.hackthebox.com/modules"><i class="mdi mdi-book-open"></i>
Modules</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://academy.hackthebox.com/paths"><i class="mdi mdi-map-marker-path"></i> Paths</a>
</li>
</ul>
</div>
</nav>
</div>
</div>
</div>
</div>
</header>
<div class="main-content">
<div class="page-content">
<div class="row">
<div class="col-12">
<div class="page-title-box d-flex align-items-center justify-content-between">
<h4 class="page-title mb-0 font-size-18 letter-spacing-1">Introduction to Web Applications  <i class="favouriteBtn fa fa-heart text-danger" data-module-id="75" data-original-title="" data-title="Toggle To-Do" data-toggle="tooltip" style="cursor:pointer;" title=""></i></h4>
<div class="page-title-right">
<ol class="breadcrumb m-0">
<li class="breadcrumb-item"><a href="javascript: void(0);">Page 15</a></li>
<li class="breadcrumb-item active">Common Web Vulnerabilities</li>
</ol>
</div>
</div>
</div>
</div>
<div class="row justify-content-xl-center">
<div class="col-md-12 col-xl-9 col-xxl-7">
<div class="training-module">
<h1>Common Web Vulnerabilities</h1>
<hr/>
<p>If we were performing a penetration test on an internally developed web application or did not find any public exploits for a public web application, we may manually identify several vulnerabilities. We may also uncover vulnerabilities caused by misconfigurations, even in publicly available web applications, since these types of vulnerabilities are not caused by the public version of the web application but by a misconfiguration made by the developers. The below examples are some of the most common vulnerability types for web applications, part of <a href="https://owasp.org/www-project-top-ten/" rel="noopener nofollow" target="_blank">OWASP Top 10</a> vulnerabilities for web applications.</p>
<hr/>
<h2>Broken Authentication/Access Control</h2>
<p><code>Broken authentication</code> and <code>Broken Access Control</code> are among the most common and most dangerous vulnerabilities for web applications.</p>
<p><code>Broken Authentication</code> refers to vulnerabilities that allow attackers to bypass authentication functions. For example, this may allow an attacker to login without having a valid set of credentials or allow a normal user to become an administrator without having the privileges to do so.</p>
<p><code>Broken Access Control</code> refers to vulnerabilities that allow attackers to access pages and features they should not have access to. For example, a normal user gaining access to the admin panel.</p>
<p>For example, <code>College Management System 1.2</code> has a simple <a href="https://www.exploit-db.com/exploits/47388" rel="noopener nofollow" target="_blank">Auth Bypass</a> vulnerability that allows us to login without having an account, by inputting the following for the email field: <code>' or 0=0 #</code>, and using any password with it.</p>
<hr/>
<h2>Malicious File Upload</h2>
<p>Another common way to gain control over web applications is through uploading malicious scripts. If the web application has a file upload feature and does not properly validate the uploaded files, we may upload a malicious script (i.e., a <code>PHP</code> script), which will allow us to execute commands on the remote server.</p>
<p>Even though this is a basic vulnerability, many developers are not aware of these threats, so they do not properly check and validate uploaded files. Furthermore, some developers do perform checks and attempt to validate uploaded files, but these checks can often be bypassed, which would still allow us to upload malicious scripts.</p>
<p>For example, the WordPress Plugin <code>Responsive Thumbnail Slider 1.0</code> can be exploited to upload any arbitrary file, including malicious scripts, by uploading a file with a double extension (i.e. <code>shell.php.jpg</code>). There's even a <a href="https://www.rapid7.com/db/modules/exploit/multi/http/wp_responsive_thumbnail_slider_upload/" rel="noopener nofollow" target="_blank">Metasploit Module</a> that allows us to exploit this vulnerability easily.</p>
<hr/>
<h2>Command Injection</h2>
<p>Many web applications execute local Operating System commands to perform certain processes. For example, a web application may install a plugin of our choosing by executing an OS command that downloads that plugin, using the plugin name provided. If not properly filtered and sanitized, attackers may be able to inject another command to be executed alongside the originally intended command (i.e., as the plugin name), which allows them to directly execute commands on the back end server and gain control over it. This type of vulnerability is called <a href="https://owasp.org/www-community/attacks/Command_Injection" rel="noopener nofollow" target="_blank">command injection</a>.</p>
<p>This vulnerability is widespread, as developers may not properly sanitize user input or use weak tests to do so, allowing attackers to bypass any checks or filtering put in place and execute their commands.</p>
<p>For example, the WordPress Plugin <code>Plainview Activity Monitor 20161228</code> has a <a href="https://www.exploit-db.com/exploits/45274" rel="noopener nofollow" target="_blank">vulnerability</a> that allows attackers to inject their command in the <code>ip</code> value, by simply adding <code>| COMMAND...</code> after the <code>ip</code> value.</p>
<hr/>
<h2>SQL Injection (SQLi)</h2>
<p>Another very common vulnerability in web applications is a <code>SQL Injection</code> vulnerability. Similarly to a Command Injection vulnerability, this vulnerability may occur when the web application executes a SQL query, including a value taken from user-supplied input.</p>
<p>For example, in the <code>database</code> section, we saw an example of how a web application would use user-input to search within a certain table, with the following line of code:</p>
<div class="window_container"><div class="window_content"><div class="window_top">Code: <span class="text-success">php</span></div><pre class="language-php"><code class="language-php"><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"select * from users where name like '%<span class="token interpolation"><span class="token variable">$searchInput</span></span>%'"</span><span class="token punctuation">;</span>
</code></pre></div></div>
<p>If the user input is not properly filtered and validated (as is the case with <code>Command Injections</code>), we may execute another SQL query alongside this query, which may eventually allow us to take control over the database and its hosting server.</p>
<p>For example, the same previous <code>College Management System 1.2</code> suffers from a SQL injection <a href="https://www.exploit-db.com/exploits/47388" rel="noopener nofollow" target="_blank">vulnerability</a>, in which we can execute another <code>SQL</code> query that always returns <code>true</code>, meaning we successfully authenticated, which allows us to log in to the application. We can use the same vulnerability to retrieve data from the database or even gain control over the hosting server.</p>
<p>We will see these vulnerabilities again and again in our learning journey and real-world assessments. It is important to become familiar with each of these as even a basic understanding of each will give us a leg up in any information security realm. Later modules will cover each of these vulnerabilities in-depth.</p>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below to complete this Section and earn cubes!</p>
</div>
<div class="col-3 text-right float-right">
</div>
</div>
<div>
<div>
<label class="module-question" for="449"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> To which of the above categories does public vulnerability 'CVE-2014-6271' belongs to?</label>
<div class="row">
<div class="col-lg-8 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer449" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="449" id="btnAnswer449"><i class="fad fa-flag-checkered mr-2"></i> Submit</button>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-outline-warning btn-block" data-target="#hint449" data-toggle="modal" id="hintBtn449"><i class="fad fa-life-ring mr-2"></i> Hint</button>
</div>
</div>
<div class=""></div>
</div>
</div>
</div>
</div>
</div>
<div class="card bg-color-blue-nav" style="margin: 30px 0">
<div class="card-body">
<a class="btn btn-light module-button py-2" href="https://academy.hackthebox.com/module/75/section/762" style="float: left"><i class="fa fa-arrow-alt-left mr-1"></i> Previous</a>
<form action="https://academy.hackthebox.com/module" class="form-inline" id="completeForm" method="POST" style="float: right">
<input name="module_id" type="hidden" value="75"/>
<input name="page_id" type="hidden" value="16"/>
<input name="completed" type="hidden" value="1"/>
<button class="btn btn-outline-success" id="completeBtn" style="display:none;"><i class="fa fa-check-circle"></i> Mark Complete &amp; Next</button>
</form>
<a class="btn btn-light ml-2 module-button py-2" href="Introduction to Web Applications16.html" style="float: left">Next <i class="ml-1 fa fa-arrow-alt-right"></i></a>
</div>
</div>
</div>
<div class="col-md-12 col-xl-3 col-xxl-3">
<div id="table-of-contents">
<div class="card">
<div class="card-body bg-color-blue-nav">
<a class="btn btn-light btn-block module-button" href="https://academy.hackthebox.com/module/75/section/764#questionsDiv"><i class="fad fa-question mr-2"></i> Go to Questions</a>
</div>
</div>
<div class="card" id="TOC">
<div class="card-body bg-color-blue-nav">
<h5 class="card-title font-size-15 mb-4">Table of Contents</h5>
<h6 class="mt-4 mb-2">Introduction to Web Applications</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/719">
<span class="font-size-13">Introduction</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/751">
<span class="font-size-13">Web Application Layout</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/752">
<span class="font-size-13">Front End vs. Back End</span>
</a>
<h6 class="mt-4 mb-2">Front End Components</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/753">
<span class="font-size-13">HTML</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/754">
<span class="font-size-13">Cascading Style Sheets (CSS)</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/755">
<span class="font-size-13">JavaScript</span>
</a>
<h6 class="mt-4 mb-2">Front End Vulnerabilities</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/756">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Sensitive Data Exposure</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/757">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">HTML Injection</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/758">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Cross-Site Scripting (XSS)</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/828">
<span class="font-size-13">Cross-Site Request Forgery (CSRF)</span>
</a>
<h6 class="mt-4 mb-2">Back End Components</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/759">
<span class="font-size-13">Back End Servers</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/760">
<span class="font-size-13">Web Servers</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/761">
<span class="font-size-13">Databases</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/762">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Development Frameworks &amp; APIs</span>
</a>
<h6 class="mt-4 mb-2">Back End Vulnerabilities</h6> <a class="btn text-primary btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/764">
<span class="font-size-13">Common Web Vulnerabilities</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/763">
<span class="font-size-13">Public Vulnerabilities</span>
</a>
<h6 class="mt-4 mb-2">Next Steps</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/75/section/819">
<span class="font-size-13">Next Steps</span>
</a>
</div>
</div>
<div class="card">
<div class="card-body bg-color-blue-nav">
<h5 class="card-title mb-4">My Workstation</h5>
<div class="row">
<div class="col-12">
<div id="sidePreview" style="height: 160px; border: 1px solid #323232; border-radius: 5px; background-color: #0a121c; text-align: center">
<div class="screenPlaceholder">
<p class="instanceStart" style="padding-top:70px; letter-spacing: 5px;">OFFLINE</p>
<p class="instanceLoading" style="padding-top:70px; display: none"><i class="fa fa-circle-notch fa-spin"></i> Starting...</p>
</div>
</div>
</div>
<div class="col-12 mt-2">
<div class="instanceStart">
<button class="startInstanceBtn btn btn-light btn-sm mt-2 btn-block module-button py-2"><i class="fad fa-play-circle text-success"></i>  Start Instance</button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
</p>
</div>
<button class="fullScreenBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none;"><i class="fad fa-expand text-success"></i>  Interact</button>
<button class="terminateInstanceBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate</button>
<button class="resetInstanceBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none;"><i class="fad fa-sync text-warning"></i>  Reset</button>
<div class="btn-group" role="group">
<button class="extendInstanceBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none; cursor: default;">Life Left: <span class="lifeLeft"></span>m</button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm mt-2 module-button py-2" data-original-title="" data-title="Extend Life" data-toggle="tooltip" style="display:none;" title=""><i class="fa fa-plus text-success"></i></button>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div aria-hidden="true" aria-labelledby="hint449" class="modal fade" id="hint449" role="dialog" tabindex="-1">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-body">
<div class="text-center">
<h5><i class="fad fa-life-ring text-success"></i>  Hint</h5>
<br/>
<h6>It's on of the above! Simply search for the vulnerability description and read about it, and you'll know the answer.</h6>
</div>
</div>
</div>
</div>
</div>
<div aria-hidden="true" aria-labelledby="unlockModuleModal" class="modal fade" id="cheatSheetModal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-body">
<div class="text-center text-break">
<h5><i class="fad fa-file-alt"></i>  Cheat Sheet</h5>
<p>The cheat sheet is as a useful command reference for this module.</p>
</div>
</div>
<div class="modal-footer">
<a class="btn btn-light btn-block" href="https://academy.hackthebox.com/module/cheatsheet/75">Download Cheatsheet</a>
</div>
</div>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row">
<div class="col-sm-6">
</div>
<div class="col-sm-6">
<div class="text-sm-right d-none d-sm-block">
Powered by   <a href="https://www.hackthebox.com/" target="_blank"><img height="20px" src="./Introduction to Web Applications15_files/logo-htb.svg" style="margin-bottom: 1px;"/></a>
</div>
</div>
</div>
</div>
</footer>
</div>
</div>
</div>
<script src="./Introduction to Web Applications15_files/jquery.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/bootstrap.bundle.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/metisMenu.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/simplebar.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/waves.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/toastr.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/axios.min.js.download"></script>
<script src="./Introduction to Web Applications15_files/prism.js.download"></script>
<script src="./Introduction to Web Applications15_files/main.js.download"></script>
<script>
    axios.defaults.headers.common = {
        'X-CSRF-TOKEN': 'hFahg3PlVpA6oyzTnlKVFlcJ6V0GIvc59OYzEA7F',
        'X-Requested-With': 'XMLHttpRequest',
        'Authorization': 'Bearer ' + 'jgfghW9jOUxTYrPOMG9i2ujbtUFdtKuilcFrKtLWJpv9gAzKxNnjcsm7Dg2wIx8ivYvDBp7jCWD5XRNP'
    };
</script>
<script>
    $('table').addClass('table table-striped text-left').wrap('<div class="table-responsive"></div>');

    $('.training-module a').attr('target','_blank').attr('rel','noopener nofollow');

    $( ".favouriteBtn" ).click(function() {
        let id = $(this).data('module-id');

        axios.get('/api/modules/favourite/'+id).then(response => {
            let data = response.data;
            if (data.fav === 1) {
                $(this).removeClass('far fa').addClass('fa');
                toastr["success"](data.message, "Success");
            } else {
                $(this).removeClass('far fa').addClass('far');
                toastr["success"](data.message, "Success");
            }
        });
    });

    function encode_utf8(string) {
    return unescape(encodeURIComponent(string));
  }

  $('.btnAnswer').click(function() {
    let question_id = $(this).data('question-id');
    $(this).attr('disabled', 1);
    let utf8EncodedString = encode_utf8($('#answer' + question_id).val());
    axios.post('/api/check/answer', {
      answer: btoa(utf8EncodedString),
      question_id: question_id
    }).then(response => {
      $(this).removeAttr('disabled');
      let data = response.data;
      if (data.success === 0) {
        toastr['error'](data.message, 'Error');
      } else {
        $(this).attr('disabled', 1);
        $('#answer' + question_id).attr('disabled', 1);
        $('#answer' + question_id).addClass('text-success');
        $('#hintBtn' + question_id).attr('disabled', 1);
        toastr['success'](data.message, 'Success');
        completeCheck();
      }
    });
  });

  $('.btnAnswerExercise').click(function() {
    let exercise_id = $(this).data('exercise-id');
    $(this).attr('disabled', 1);
    let utf8EncodedString = encode_utf8($(`#exerciseAnswer${exercise_id}`).val());
    axios.post(`/api/check/exercise/${exercise_id}/answer`, {
      answer: btoa(utf8EncodedString)
    }).then(response => {
      $(this).removeAttr('disabled');
      let data = response.data;
      if (data.success === 0) {
        toastr['error'](data.message, 'Error');
      } else {
        $(this).attr('disabled', 1);
        $(`#exerciseAnswer${exercise_id}`).attr('disabled', 1);
        $(`#exerciseAnswer${exercise_id}`).addClass('text-success');
        toastr['success'](data.message, 'Success');
      }
    });
  });

    
    $('.reveal-modal').click(e => {
        let id = $(e.target).data('exercise-id');
        $(`#revealExerciseAnswer${id}`).modal('hide');
    });

    $( document ).ready(function() {

        $('pre').filter(function () {
            return this.className.match(/\blanguage-/);
        }).each(function () {
            let heading = $(this).prevAll().closest('h4').last().text();

            if (this.className === ' language-shell-session') {
                wrapTerminal(this, heading);
            } else if (this.className === ' language-powershell-session') {
                wrapPSTerminal(this, heading);
            } else if (this.className === ' language-cmd-session') {
                wrapCMDTerminal(this, heading);
            } else if (this.className.startsWith(' language-')) {
                var language = this.className.split('-').pop();
                wrapCodeBlock(this,language);
            }
        });

        wrapBrowser($('.website-screenshot'));
        completeCheck();

        $("span:contains('[!bash!]')").html('<span class="text-gray">Tommy034@htb</span><span class="text-success">[/htb]</span>');
    });

    function completeCheck()
    {
        axios.get('/api/check/complete/764').then(response => {
            let data = response.data;
            if (data.success === 1) {
                if (data.completed === true) {
                    $('#completeBtn').show();
                }
            }
        });
    }

    function wrapTerminal(element, heading)
    {
        $(element).css('line-height', '0px');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <span class="window_title">${heading}</span>
                </div>
            `);
    }
    function wrapPSTerminal(element, heading)
    {
        $(element).css('background', '#012456').children().css('color','white');
        $(element).css('line-height', '0px');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <span class="window_title">${heading}</span>
                </div>
            `);
    }
    function wrapCMDTerminal(element, heading)
    {
        $(element).css('background', 'black').children().css('color','white');
        $(element).css('line-height', '0px');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <span class="window_title">${heading}</span>
                </div>
            `);
    }
    function wrapCodeBlock(element,lang)
    {
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend('<div class="window_top">Code: <span class="text-success">'+lang+'</div>');
    }
    function wrapBrowserOld(element)
    {
        $(element).css("border", "0px").css("border-radius","0");
        let url = element.data('url');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <input type="text" class="website-screenshot-url" disabled value="${url}">
                    <span class="float-right"><i class="fa fa-home"></i></span>
                </div>
            `);
    }
    function wrapBrowser(element)
    {
        $(element).css("border", "0px").css("border-radius","0");

        $(element).each( function(index,e) {
            let url = $(e).data('url');
            $(e).wrap('<div class="window_content"></div>')
                .parent().wrap('<div class="window_container"></div>')
                .prepend(`
                    <div class="window_top">
                        <span class="mr-2">
                            <i class="fa fa-arrow-circle-left"></i> <i class="fa fa-arrow-right"></i> <i class="fa fa-redo"></i> <i class="fa fa-home"></i>
                        </span>
                        <input type="text" class="website-screenshot-url" disabled value="${url}">
                        <span class="float-right"><i class="fa fa-bars"></i></span>
                    </div>
                `);
        })
    }
</script>
<script type="module">
    import RFB from '/assets/libs/vnc/core/rfb.js';

    let rfb;
    let sidePreview;
    let desktopName;
    let pwnboxActive = false;

    function connectedToServer(e) {
        status("Connected to " + desktopName);
        $('.fullScreenBtn').show();
        $('.resetInstanceBtn').show();
        $('.terminateInstanceBtn').show();
        $('.extendInstanceBtn').show();
        $('.instanceLoading').hide();
        $('.instanceStart').hide();
        $('.resetInstanceBtn').prop('disabled',false);
        $('.fullScreenBtn').prop('disabled',false);
        $('.extendInstanceBtn').prop('disabled',false);
        $('.terminateInstanceBtn').prop('disabled',false);

        document.querySelector('canvas').addEventListener('focus', (event) => {
            navigator.clipboard.readText()
                .then(text => {
                    writeToClipboard(text);
                })
                .catch(err => {
                    console.log('Something went wrong while accessing clipboard', err);
                })
        });

    }

    function disconnectedFromServer(e) {
        status("Disconnected");
        $('.screenPlaceholder').show();
        stopCountdown();
    }

    function clipboardReceived(e) {
        navigator.clipboard.writeText(e.detail.text)
            .then(() => {
                // Success!
            })
            .catch(err => {
                console.log('Something went wrong while copying to clipboard.', err);
            });
    }

    function updateDesktopName(e) {
        desktopName = e.detail.name;
    }

    function status(text) {
        console.log(text);
        $("#statusText").html(text);
    }

    function readQueryVariable(name) {
        const re = new RegExp('.*[?&]' + name + '=([^&#]*)'),
            match = document.location.href.match(re);

        if (match) {
            return decodeURIComponent(match[1]);
        }

        return null;
    }

    function writeToClipboard(text) {
        rfb.clipboardPasteFrom(text);
    }

    let host = '';
    let password = '';
    let countdown = '';
    let targetCountdown = '';
    let url= '';
    let spawnInterval = null;

    function getPwnbox() {
        axios.get('/api/get/pwnbox').then(response => {
            let data = response.data;

            if (spawnInterval !== null && data.instance.action_log !== null) {
                let error = data.instance.action_log.find(log => log.error === true);
                if (error) {
                    $('.resetInstanceBtn').prop('disabled',false);
                    $('.fullScreenBtn').prop('disabled',false);
                    $('.extendInstanceBtn').prop('disabled',false);
                    $('.terminateInstanceBtn').prop('disabled',false);
                    $('.instanceStart').show();
                    $('.instanceLoading').hide();
                    $('.startInstanceBtn').show();

                    clearInterval(spawnInterval);
                    disconnectedFromServer();

                    let errorMessage = `${error.text}. Please contact support.`;
                    toastr["error"](errorMessage, "Error");

                    status(errorMessage);
                    return;
                }
            }

            if (data.success === 1 && data.instance.vnc_password !== null) {
                if (data.instance.action_log.find(log => log.action === 'ready')) {
                    host = 'proxy-uk.htb-cloud.com/bird/' + data.instance.hostname;
                    password = data.instance.vnc_password;
                    $('.lifeLeft').html(data.instance.life_remaining);
                    startCountdown();
                    $('.screenPlaceholder').hide();
                    url = 'https://vnc.htb-cloud.com/index.html?host=' + host + '&password=' + password;
                    pwnboxActive = true;
                    connect();

                    if (spawnInterval !== null) {
                        clearInterval(spawnInterval);
                    }
                }
            } else {
                $('.screenPlaceholder').show();
            }

        });
    }

        function extendPwnbox() {
        axios.get('/api/extend/pwnbox').then(response => {
            let data = response.data;
            if (data.success === 1) {
                $('.lifeLeft').html(data.instance.life_remaining);
                stopCountdown();
                startCountdown();
                toastr["success"]("Time extended for 60 minutes.", "Success");
            } else {
                toastr["error"](data.message, "Error");
            }

        });
    }
    
    getPwnbox();

    function startCountdown() {
        countdown = setInterval(function() {
            let life = parseInt($('.lifeLeft').html()) -1;
            $('.lifeLeft').html(life)
        }, 60 * 1000);
    }

    function stopCountdown() {
        clearInterval(countdown);
    }

    function terminatePwnbox() {
        $('.resetInstanceBtn').prop('disabled',true);
        $('.terminateInstanceBtn').prop('disabled',true);
        $('.fullScreenBtn').prop('disabled',true);
        $('.extendInstanceBtn').prop('disabled',true);
        $('.instanceStart').hide();

        $('.instanceTerminating').show();

        status('Terminating Interactive Instance...');

        axios.delete('/api/terminate/pwnbox')
            .then(({ data }) => {
                if (data.success === 1) {
                    $('.startInstanceBtn').show();
                    $('.instanceStart').show();
                    $('.instanceTerminating').hide();
                    $('.resetInstanceBtn').hide();
                    $('.terminateInstanceBtn').hide();
                    $('.fullScreenBtn').hide();
                    $('.extendInstanceBtn').hide();

                    pwnboxActive = false;

                    toastr['success']('Instance has been terminated.', 'Success');
                } else {
                    toastr['error'](data.message, 'Error');
                    connect();
                    $('.resetInstanceBtn').prop("disabled", false);
                    $('.fullScreenBtn').prop('disabled',false);
                    $('.extendInstanceBtn').prop('disabled',false);
                    $('.terminateInstanceBtn').prop('disabled',false);
                }
            });
    }

    function startPwnbox() {
        $('.resetInstanceBtn').prop('disabled',true);
        $('.fullScreenBtn').prop('disabled',true);
        $('.extendInstanceBtn').prop('disabled',true);
        $('.terminateInstanceBtn').prop('disabled',true);
        $('.instanceStart').hide();
        $('.instanceLoading').show();
        $('.startInstanceBtn').hide();

        status("Starting Interactive Instance...");

        grecaptcha.ready(function() {
            grecaptcha.execute('6LeI6LsaAAAAAKgdStgBC6B4UVbXlpYNaYGN46Ah', {action: 'spawnPwnbox'}).then(function(token) {
                if (token) {
                    axios.get('/api/spawn/pwnbox?g-recaptcha-response= '+token).then(response => {
                        let data = response.data;
                        if (data.success === 1) {
                            spawnInterval = setInterval(() => {
                                getPwnbox();
                            }, 2000);
                        } else {
                            if(data.code === 1 || (data.code === 3 && pwnboxActive)) {
                                $('.resetInstanceBtn').prop("disabled", false);
                                $('.fullScreenBtn').prop('disabled',false);
                                $('.extendInstanceBtn').prop('disabled',false);
                                $('.terminateInstanceBtn').prop('disabled',false);
                                connect();

                                if (data.code === 3) {
                                    $('.instanceLoading').hide();
                                    startCountdown();
                                }
                            } else {
                                $('.startInstanceBtn').show();
                                $('.instanceStart').show();
                                $('.instanceLoading').hide();
                            }

                            toastr["error"](data.message, "Error");
                        }

                    });
                } else {
                    $('.resetInstanceBtn').prop('disabled',false);
                    $('.fullScreenBtn').prop('disabled',false);
                    $('.extendInstanceBtn').prop('disabled',false);
                    $('.terminateInstanceBtn').prop('disabled',false);
                    $('.instanceStart').show();
                    $('.instanceLoading').hide();
                    $('.startInstanceBtn').show();
                }
            });
        });
    }

    $('.fullScreenBtn').click(function() {
        window.open(url, "_blank");
    });

    $('.startInstanceBtn').click(function() {
        startPwnbox();
            });

    $('.resetInstanceBtn').click(function() {
        $('.screenPlaceholder').show();
        $('.instanceStart').show();
                sidePreview.disconnect();
        startPwnbox();
    });

    $('.terminateInstanceBtn').click(function() {
        $('.screenPlaceholder').show();
        $('.instanceStart').show();
                sidePreview.disconnect();
        terminatePwnbox();
    });

    $('.extendInstanceBtnClicker').click(function() {
       extendPwnbox();
    });

    $('.resetTargetBtn').click(function(){
        $(this).prop('disabled',true);
                    });

    function connect() {
        status("Connecting to " + host.split('/')[2] + "...");

        
        sidePreview = new RFB(document.getElementById('sidePreview'), 'wss://' + host,
            { credentials: { password: password } });

        sidePreview.addEventListener("connect",  connectedToServer);
        sidePreview.addEventListener("disconnect", disconnectedFromServer);

        sidePreview.resizeSession = false;
        sidePreview.viewOnly = true;
        sidePreview.scaleViewport = true;
    }

    $('.target, .targetIp').click(e => {
        if ($('.resetTargetBtn').is(':hidden')) return;
        navigator.clipboard.writeText($(e.target).html())
            .then(() => {
                toastr['success']('Target copied to clipboard', 'Success');
            })
            .catch(err => {
                console.log('Something went wrong while copying to clipboard.', err);
            });
    });

        
    function startTargetCountdown() {
        targetCountdown = setInterval(function() {
            let life = parseInt($('.targetLifeTime').html()) -1;
            $('.targetLifeTime').html(life)
            if (life == 0) {
                $('.targetLifeTimeContainer').hide();
            }
        }, 60 * 1000);
    }
</script>
<img height="1" src="./Introduction to Web Applications15_files/adsct" style="display: none;" width="1"/><img height="1" src="./Introduction to Web Applications15_files/adsct(1)" style="display: none;" width="1"/><iframe aria-hidden="true" id="intercom-frame" src="./Introduction to Web Applications15_files/saved_resource.html" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" tabindex="-1" title="Intercom"></iframe><div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s ease 0s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe frameborder="0" height="60" name="a-xt74qwu6n557" role="presentation" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" scrolling="no" src="./Introduction to Web Applications15_files/anchor.html" title="reCAPTCHA" width="256"></iframe></div><div class="grecaptcha-error"></div><textarea class="g-recaptcha-response" id="g-recaptcha-response-100000" name="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe src="./Introduction to Web Applications15_files/saved_resource(1).html" style="display: none;"></iframe></div><div class="intercom-lightweight-app"><div aria-label="Open Intercom Messenger" aria-live="polite" class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><svg viewbox="0 0 28 32" xmlns="http://www.w3.org/2000/svg"><path d="M28 32s-4.714-1.855-8.527-3.34H3.437C1.54 28.66 0 27.026 0 25.013V3.644C0 1.633 1.54 0 3.437 0h21.125c1.898 0 3.437 1.632 3.437 3.645v18.404H28V32zm-4.139-11.982a.88.88 0 00-1.292-.105c-.03.026-3.015 2.681-8.57 2.681-5.486 0-8.517-2.636-8.571-2.684a.88.88 0 00-1.29.107 1.01 1.01 0 00-.219.708.992.992 0 00.318.664c.142.128 3.537 3.15 9.762 3.15 6.226 0 9.621-3.022 9.763-3.15a.992.992 0 00.317-.664 1.01 1.01 0 00-.218-.707z"></path></svg></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg viewbox="0 0 16 14" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M.116 4.884l1.768-1.768L8 9.232l6.116-6.116 1.768 1.768L8 12.768.116 4.884z" fill-rule="evenodd"></path></svg></div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #85C700;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    animation: intercom-lightweight-app-launcher 250ms ease;
  }

  .intercom-lightweight-app-launcher:focus {
    outline: none;
    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 60px;
    height: 60px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 28px;
    height: 32px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 56px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 36px;
    max-width: 36px;
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg {
    width: 16px;
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms ease-out;
    
        width: 376px;
        height: calc(100% - 120px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 100px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
        border-radius: 8px;
      
  }

  .intercom-lightweight-app-messenger-header {
    height: 75px;
    background: linear-gradient(
      135deg,
      rgb(17, 25, 39) 0%,
      rgb(0, 0, 0) 100%
    );
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>